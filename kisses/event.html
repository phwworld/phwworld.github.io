<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HERSHEY`S KISSES</title>
  <link rel="stylesheet" href="./assets/css/ui.css">
</head>

<body>
  <!-- header -->
  <header>
    <h1><img src="./assets/image/logo.png" alt=""></h1>
    <button type="button" onclick="modalOpen('modal-info')"></button>
  </header>
  <!-- //header -->

  <!-- main -->
  <main>
    <!-- event -->
    <div class="event">
      <!-- inner -->
      <div class="inner">
        <img src="./assets/image/event_img1.png" alt="">
        <div class="slide">
          <div class="emotion_state">
            <div class="range_wrap">
              <div class="range_fill" style="width: 0;"></div>
              <input class="emotion_range" type="range" min="0" max="100" step="10" value="0">
            </div>
            <p class="text" style="padding-top: 10px;text-align: center;"></p>
          </div>
          <div class="img1">
            <img src="./assets/image/event_img3.png" alt="">
          </div>
        </div>

        <div class="motion">
          <img src="./assets/image/event_img2.png" alt="">
        </div>
      </div>
      <!-- //inner -->

      <!-- loading -->
      <div class="loading">
        <video playsinline muted preload="auto" poster="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
          <source src="https://connectkisses.com/assets/video/motion.mp4">
        </video>
      </div>
      <!-- //loading -->
    </div>
    <!-- //event -->
  </main>
  <!-- //main -->

  <!-- 이벤트 소개 레이어 -->
  <div class="modal-info hide">
    <img src="./assets/image/event_info1.jpg" alt="">
    <img src="./assets/image/event_info2.jpg" alt="">
    <img src="./assets/image/event_info3.jpg" alt="">
    <div class="video">
      <video id="main-video" playsinline poster="./assets/image/video_poster.png">
        <source src="https://connectkisses.com/assets/video/film.mp4">
      </video>
      <button type="button" class="play" onclick="videoPlay(this);"></button>
      <button type="button" class="pause" onclick="videoPause(this);"></button>
      <div class="mask" onclick="videoContinue(this);"></div>
    </div>
    <img src="./assets/image/event_info4.jpg" alt="">
    <img src="./assets/image/event_info5.jpg" alt="">
    <img src="./assets/image/event_info6.jpg" alt="">
    <img src="./assets/image/event_info7.jpg" alt="">
    <img src="./assets/image/event_info8.jpg" alt="">
    <img src="./assets/image/event_info9.jpg" alt="">
    <div class="btn-area">
      <button type="button" class="btn-large btn-brown w100" onclick="modalClose('modal-info')">확인</button>
    </div>

    <button type="button" class="close" onclick="modalClose(this)"></button>
  </div>

  <script src="./assets/js/ui.js"></script>
  <script>
    const eventSlider = () => {
      const newUrl = `result.html`; /* 주소변경 필요 */
      const eventLoading = document.querySelector('.event .loading');
      const loadingVideo = eventLoading.querySelector('video');
      const emotionRange = document.querySelector('.emotion_range');
      const rangeValue = () => {
        const emotionState = document.querySelector('.emotion_state');
        const stateText = emotionState.querySelector('.state_text');
        const rangeFill = emotionState.querySelector('.range_fill');
        const value = Number(emotionRange.value);
        const text = emotionState.querySelector('.text');

        rangeFill.style.width = `${emotionRange.value}%`;

        if (value === 100) {
          eventLoading.style.display = 'block';
          loadingVideo.play();
        }
        loadingVideo.addEventListener('ended', (event) => {
          window.location.replace(newUrl);
        });
      }

      emotionRange.addEventListener("input", rangeValue)

      document.addEventListener('DOMContentLoaded', function () {
        const loadingVideo = document.querySelector('.loading video');
        if (loadingVideo) {
          setTimeout(() => {
            loadingVideo.removeAttribute('poster');
          }, 100);
          
        }
      })
    }

    eventSlider();
  </script>
</body>

</html>